Проект вединговой машины для продажи косметической продукции ГК "Графа" ("Грамотная фармацея")
Автоматизированная система продажи будет в вединговой машине продавать 1, 2, 4, 8, 16 наименований продукции в одном аппарате
Вединговый аппарат имеет тестовое наименование "графамат"
Все графоматы будут связаны в единую сеть через интернет и будут служить для выдачи покупок, сделаных через интернет
Оплатить товар можно на сайте Графы, наличными деньгами и карточкой (скорее всего только безконтактной)
Управлять графоматом можно через приложение на телефоне (bluetooth?/wi-fi?/internet?)
В режиме online на карте будет отображатся состояние каждого графомата 
Каждый графомат будет иметь систему видеонаблюдения за процессом продажи продукта и как система фиксации актов вандализма
Опишем полную структуру Графомата (базовые элементы):
1) механизм выдачи товара на 12 или 16 ячеек с индивидуальной LED-подстветкой каждой
2) клавиатура выбора (на 1, 2, 4, 12 и 16 клавиш)
3) дисплей для вывода цены выбраного товара
4) купюроприемник для принятия оплат 
5) датчик выдачи с LED-подсветкой
6) принтер для печати чеков
7) управляемый замок для отрытия дверцы
8) управляемый замок для отрытия ящика
(элементы безопасности по мере их актуальности)
9) датчик отрытия ящика
10) датчик отрытия двери
11) датчик удара двери
12) датчик удара ящика
13) камера визульного наблюдения
(расширеные елемены функциональности)
14) сканер штрих-кодов и QR от WaveShare 
15) NFC ридер для оплат безконтактыми картами и системами безконтактной оплаты Android Pay, Apple pay и т.д.
16) Функции голосового помощника (реализуется через GSM модуль) для связи с call-центром
17) датчик движения 
18) непродуманная еще функция управления графоматом с помощью смартфона через блютуз
19) возможная точка доступа к Wi-Fi
20) возможность подключения интернета через кабель

Опишем базовый алгоритм работы графамата:
Подача притания привод к запуску автомата построенного скорее всего на базе контроллера ATMega2560 
1) происходить проверка закрытых датчиков дверцы и ящика
2) если один из них хотя бы открыт - переходим в режим ожидания их закрытия 
3) определяем количество механизмов выдачи: 12 или 16 (идеально автоматически, нормально на этапе заливки кода)
4) определяем режим работы Графомата по количеству товара 1,2,4,12,16(нормально на этапе заливки кода)
5) производим чтение остатков из EEPROM для 12 или 16 мехнизмов
6) производим чтение цены из EEPROM для 12 или 16 мехнизмов (изменения произошли через сервер, изначально через заливку кода)
7) чтение датчика наличия товара в выдаче (потом будем думать, что с ним делать)
8) чтение датчика наличия бумаги в принтере (потом будем думать, что с ним делать)
9) проверка статуса купюроприемника, NFC модуля, QR модуля 
10) переход в режим ожидания выбора (последовательно подствечиваем 12 или 16 механизмов выбачи товара исключая пустые)
11) после выбора оставляем подстветку на выбраном товаре (или в случай 1,2,4 товаров мехнизм который выдаст товар)
12) ожидаем изменения выбора и переходим на п. 11
12) ожидаем 60 сек? оплату и в случай ее наличия - выдаем товар
13) печатаем чек и /чек на здачу? чек на благотворительность?/
14) уменьщаем количество товара в выбраной ячеке на 1 шт и записываем значение в EEPROM
15) "сообщаем о продаже на сервер"/"сообщаем о здаче"/"сообщаем о благотворительности"
16) проверяем на наличие остатков и если они не равны 0 
14) переходим в пункт 10.
15) иначе переходим в режим ожидания с сообщением на сервер, что перешли в режим "стоп"


В режиме ожидания Графамат ожидает выбора товара. При этом каждый отдельный вид товара последовательно подсвечивается 
После нажатия кнопки в соответствии с выбранным товаром, остается подсвеченным только выбраный товар
На дисплее возле купюроприемника и терминала оплат появляется сумма оплаты
В случай подтверждения выбора путем внесения наличной оплаты или оплаты через терминал, сработает шнековый механизм и выдаст купленый и выбраный товар
Давайте начнем выбор аппаратной части:
1) Arduino ???? (1 ц.выход для сигнала оплата на все 16 снеков, 16 ц.выходов для выбора снека, клавиатура выбора - 2 pin, купюроприемник от 1 до 5 pin, Сканер QR кодов - 2 pin, NFC ридер - от 2 до 3 pin), display - 5 pin, Принтер - TX/RX - 2 pin, датчик выдачи - 1 pin, разрешение на работу - 1 pin,      
2) NoName - 4 шт контроллера управления 4 снековыми механизмами (4 вх выбора механизма и 1 вх оплаты) - самопал
2.1) TCRT5000- с датчиком предпятствия оптическим TCRT5000 (для запрета выбора пустого снека)
3) TTP223, TTP224, TTP229 - кнопоки выбора: 1 шт TTP223 или 2 шт TTP223, 1шт - TTP224, 1 шт - 229 - 2 pin)
4) ICT, NV-9, Cashcode купюроприемник ICT A7 (и аналоги) - (от 1 до 5 pin)
4.1) Barcode Scanner Module - считыватель QR кодов - TX/RX - 2 pin
4.2) NFC reader - для безконтактной оплаты - 2-3 pin
5) Дисплей (можно выводить QR код от Приватбанка для оплаты) - SPI 320x240 - 5 pin
6) Принтер - TX/RX - 2 pin
7) TCRT5000- с датчиком предпятствия оптическим TCRT5000 (для запрета работы с полным карманом выдачи) - 1 pin
часть безопасности Графомата:
8) замок двери - 1 Pin
9) датчки открытия двери - 1 Pin
10) замок ящика - 1 Pin
11) датчик ящика - 1 Pin
12) датчик удара стекла - 1 
13) датчик удара графомата - 1
14) 
